

<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cam_generic_lib module &mdash; HW_CAM 4.0 ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=064fed73"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/translations.js?v=4755f45a"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="cam_global module" href="cam_global.html" />
    <link rel="prev" title="HWCAM module" href="HWCAM.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            HW_CAM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">src</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="HWCAM.html">HWCAM module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">cam_generic_lib module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.arc_to_spline"><code class="docutils literal notranslate"><span class="pre">arc_to_spline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.calc_point_dist"><code class="docutils literal notranslate"><span class="pre">calc_point_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.cross_judge"><code class="docutils literal notranslate"><span class="pre">cross_judge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.detect_rotation"><code class="docutils literal notranslate"><span class="pre">detect_rotation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.file_chk"><code class="docutils literal notranslate"><span class="pre">file_chk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.gen_g_code_line_str"><code class="docutils literal notranslate"><span class="pre">gen_g_code_line_str()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.generate_arc_length_points"><code class="docutils literal notranslate"><span class="pre">generate_arc_length_points()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.generate_offset_function"><code class="docutils literal notranslate"><span class="pre">generate_offset_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.generate_offset_interporate_point"><code class="docutils literal notranslate"><span class="pre">generate_offset_interporate_point()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_cross_point_from_lines"><code class="docutils literal notranslate"><span class="pre">get_cross_point_from_lines()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_cross_point_from_point"><code class="docutils literal notranslate"><span class="pre">get_cross_point_from_point()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_curdir"><code class="docutils literal notranslate"><span class="pre">get_curdir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_filet_sita"><code class="docutils literal notranslate"><span class="pre">get_filet_sita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_flatten"><code class="docutils literal notranslate"><span class="pre">get_flatten()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_spline_length"><code class="docutils literal notranslate"><span class="pre">get_spline_length()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.get_spline_length_array"><code class="docutils literal notranslate"><span class="pre">get_spline_length_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.norm_3d"><code class="docutils literal notranslate"><span class="pre">norm_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.offset_line"><code class="docutils literal notranslate"><span class="pre">offset_line()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.plot_3d_cut_path"><code class="docutils literal notranslate"><span class="pre">plot_3d_cut_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.poly_to_spline"><code class="docutils literal notranslate"><span class="pre">poly_to_spline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.refine_line"><code class="docutils literal notranslate"><span class="pre">refine_line()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.refine_spline_curvature"><code class="docutils literal notranslate"><span class="pre">refine_spline_curvature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.remove_collision"><code class="docutils literal notranslate"><span class="pre">remove_collision()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.remove_same_point"><code class="docutils literal notranslate"><span class="pre">remove_same_point()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.remove_self_collision"><code class="docutils literal notranslate"><span class="pre">remove_self_collision()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cam_generic_lib.rotate"><code class="docutils literal notranslate"><span class="pre">rotate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cam_global.html">cam_global module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dxf_file.html">dxf_file module</a></li>
<li class="toctree-l2"><a class="reference internal" href="error_log.html">error_log module</a></li>
<li class="toctree-l2"><a class="reference internal" href="line_object.html">line_object module</a></li>
<li class="toctree-l2"><a class="reference internal" href="messeage_window.html">messeage_window module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HW_CAM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">src</a></li>
      <li class="breadcrumb-item active">cam_generic_lib module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cam_generic_lib.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-cam_generic_lib">
<span id="cam-generic-lib-module"></span><h1>cam_generic_lib module<a class="headerlink" href="#module-cam_generic_lib" title="Link to this heading"></a></h1>
<p>CAMで共通する処理をまとめたライブラリ</p>
<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.arc_to_spline">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">arc_to_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arc_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.arc_to_spline" title="Link to this definition"></a></dt>
<dd><p>ezdxfのArcオブジェクトから、座標点列を作成する</p>
<p>座標点列は、10degに1点作成する。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arc_obj</strong>(<em>ezdxf.entities.Arc</em>)--ezdxfの円弧オブジェクト</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.array</strong>-- 円弧上のx, y座標点列</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://ezdxf.readthedocs.io/en/stable/dxfentities/arc.html#ezdxf.entities.Arc">https://ezdxf.readthedocs.io/en/stable/dxfentities/arc.html#ezdxf.entities.Arc</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.calc_point_dist">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">calc_point_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.calc_point_dist" title="Link to this definition"></a></dt>
<dd><p>z1とz2の並行した２平面上の、対応するx,y座標とu,v座標間の距離を計算する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--z1の平面に存在するx座標点列(x[i],y[i])と(u[i],v[i])は対応する</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--z1の平面に存在するy座標点列(x[i],y[i])と(u[i],v[i])は対応する</p></li>
<li><p><strong>u</strong>(<em>numpy.array</em>)--z2の平面に存在するu座標点列(x[i],y[i])と(u[i],v[i])は対応する</p></li>
<li><p><strong>v</strong>(<em>numpy.array</em>)--z2の平面に存在するv座標点列(x[i],y[i])と(u[i],v[i])は対応する</p></li>
<li><p><strong>z1</strong>(<em>float</em>)--x,y座標点列が存在する平面のz座標</p></li>
<li><p><strong>z2</strong>(<em>float</em>)--u,v座標点列が存在する平面のz座標</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.array</strong>-- 対応する(x[i],y[i])と(u[i],v[i])間の距離を計算した配列</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.cross_judge">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">cross_judge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.cross_judge" title="Link to this definition"></a></dt>
<dd><p>4点(a,b,c,d)が交差するかを判定する</p>
<p>アルゴリズムは、参考のものをそのまま実装</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong>(<em>numpy.array</em>)--aの座標(x,y)</p></li>
<li><p><strong>b</strong>(<em>numpy.array</em>)--bの座標(x,y)</p></li>
<li><p><strong>c</strong>(<em>numpy.array</em>)--cの座標(x,y)</p></li>
<li><p><strong>d</strong>(<em>numpy.array</em>)--dの座標(x,y)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bool</strong>-- True:交差する/ False:交差しない</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://qiita.com/wihan23/items/03efd7cd40dfec96a987">https://qiita.com/wihan23/items/03efd7cd40dfec96a987</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.detect_rotation">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">detect_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.detect_rotation" title="Link to this definition"></a></dt>
<dd><p>点列の回転方向（ccw/cw）を検出する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--y座標点列</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bool</strong>-- ccwかcwか(True:CCW, False/CW)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://okwave.jp/qa/q5568876.html">https://okwave.jp/qa/q5568876.html</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.file_chk">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">file_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.file_chk" title="Link to this definition"></a></dt>
<dd><p>dxfファイルが存在し、かつ拡張子がdxfかを確認する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong>(<em>str</em>)--dxfファイルのパス</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>int</strong>-- チェック結果(1:OK, 0:ファイルの拡張子がdxfでない, -1:ファイルが存在しない)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.gen_g_code_line_str">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">gen_g_code_line_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnc_cs_def</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.gen_g_code_line_str" title="Link to this definition"></a></dt>
<dd><p>座標点列からGコードに出力する文字列を作成する</p>
<p>Gコードは、G01で生成する</p>
<p>G01のFeedRate(F)は、xy平面のカット速度指令値およびuv平面のカット速度指令値を用いて、CNCコントローラーにおける速度指令値の解釈方法に併せて、以下のように計算する</p>
<ol class="arabic">
<li><dl>
<dt>CNCコントローラーがXY(UV)座標軸の速度を採用している場合</dt><dd><p>この場合、XY(UV)のカット速度指令値をそのままFeedRateとする</p>
<div class="math notranslate nohighlight">
\[F =  CS_{xy}\]</div>
</dd>
</dl>
</li>
<li><dl>
<dt>CNCコントローラーがXYU(XYV)座標軸の速度を採用している場合</dt><dd><p>この場合は、CAMはXY座標速度でカットしたいにもかかわらず、U(V)軸の移動速度もCNCコントローラー側は考慮してしまう</p>
<p>よって、XY速度をXYU速度に直して指令値とする</p>
<div class="math notranslate nohighlight">
\[F = CS_{xy}\cdot\frac{\sqrt{\Delta x^2 + \Delta y^2 +\Delta u^2 }}{\sqrt{\Delta x^2 + \Delta y^2 }}\]</div>
</dd>
</dl>
</li>
<li><dl>
<dt>CNCコントローラーがG93(逆時間送り)を採用している場合</dt><dd><p>この場合、次の点までの移動時間をFeedRateとする</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F_{xy} = \frac{\sqrt{\Delta x^2 + \Delta y^2 }}{CS_{xy}}\\F_{uv} = \frac{\sqrt{\Delta u^2 + \Delta v^2 }}{CS_{uv}}\\F = min(F_{xy}, F_{uv})\end{aligned}\end{align} \]</div>
</dd>
</dl>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--Gコードに出力するx座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--Gコードに出力するy座標点列</p></li>
<li><p><strong>u</strong>(<em>numpy.array</em>)--Gコードに出力するu座標点列</p></li>
<li><p><strong>v</strong>(<em>numpy.array</em>)--Gコードに出力するv座標点列</p></li>
<li><p><strong>x0</strong>(<em>float</em>)--x[0]の前の座標点（前の線の終端点のx座標）</p></li>
<li><p><strong>y0</strong>(<em>float</em>)--y[0]の前の座標点（前の線の終端点のy座標）</p></li>
<li><p><strong>u0</strong>(<em>float</em>)--u[0]の前の座標点（前の線の終端点のu座標）</p></li>
<li><p><strong>v0</strong>(<em>float</em>)--v[0]の前の座標点（前の線の終端点のv座標）</p></li>
<li><p><strong>cs_xy</strong>(<em>float</em>)--xy平面側のCNC駆動面におけるカット速度指令値</p></li>
<li><p><strong>cs_uv</strong>(<em>float</em>)--uv平面側のCNC駆動面におけるカット速度指令値</p></li>
<li><p><strong>cnc_cs_def</strong>(<em>str</em>)--CNCコントローラーにおける速度指令値の解釈方法</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>str</strong>-- Gコードに出力する文字列</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.generate_arc_length_points">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">generate_arc_length_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.generate_arc_length_points" title="Link to this definition"></a></dt>
<dd><p>線を等間隔分割した座標点を算出する</p>
<p>点の場合、同じ座標をN個格納した配列を出力する</p>
<p>線分の場合、線をN分割した配列を出力する</p>
<p>スプラインの場合、スプライン補完関数により線長をN等分した配列を出力する</p>
<p>スプラインで線長をN等分する場合、i(i=0...N）点目までの線長を計算し、これを0~1に正規化した媒介変数を用いて座標点列を補完することで、等間隔の媒介変数を用いて補完点列を作成すると、出力される座標点列の間隔も線長に対して等間隔となる</p>
<p>スプライン補完の補完方法は、CADと同じ3次スプラインと、角があっても線がうねらないPCHIPアルゴリズムを選択できるようにする</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line</strong>(<a class="reference internal" href="line_object.html#line_object.LineObject" title="line_object.LineObject"><em>LineObject</em></a>)--LineObjectクラスのインスタンス</p></li>
<li><p><strong>N</strong>(<em>int</em>)--等間隔分割点数</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- 等間隔分割後のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- 等間隔分割後のy座標点列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.generate_offset_function">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">generate_offset_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.generate_offset_function" title="Link to this definition"></a></dt>
<dd><p>カット速度vs溶け量のグラフから線形補完関数を作成する</p>
<p>グラフの範囲外のカット速度がCAM側で計算された場合に備えて、0~10000 mm/minの範囲で端点を0次ホールドする更に、保管時に外挿オプション（fill_value=&quot;extrapolate&quot;）とする</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_array</strong>(<em>numpy.array</em>)--カット速度</p></li>
<li><p><strong>y_array</strong>(<em>numpy.array</em>)--オフセット量（溶け量）</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>interp1d</strong>-- オフセット関数のオブジェクト</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.generate_offset_interporate_point">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">generate_offset_interporate_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l0_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_offset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.generate_offset_interporate_point" title="Link to this definition"></a></dt>
<dd><p>線をオフセットしてできた2本の線分l0とl1について、l0とl1の端点の隙間に、l0-&gt;l1の方向へフィレットを作成する</p>
<p>フィレット半径は、オフセット距離となる。l0とl1でオフセット距離が異なる場合は、小さい値を採用する。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l0_x</strong>(<em>float</em>)--l0のx座標</p></li>
<li><p><strong>l0_y</strong>(<em>float</em>)--l0のy座標</p></li>
<li><p><strong>l1_x</strong>(<em>float</em>)--l1のx座標</p></li>
<li><p><strong>l1_y</strong>(<em>float</em>)--l1のy座標</p></li>
<li><p><strong>l0_offset</strong>(<em>float</em>)--l0のオフセット距離</p></li>
<li><p><strong>l1_offset</strong>(<em>float</em>)--l1のオフセット距離</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- フィレットのx座標</p></li>
<li><p><strong>numpy.array</strong>-- フィレットのy座標</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>フィレット半径がDIST_FILET未満と十分小さい場合は、空行列を出力する</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_cross_point_from_lines">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_cross_point_from_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_cross_point_from_lines" title="Link to this definition"></a></dt>
<dd><p>傾きa,切片bの直線と、傾きc,切片dの直線の交点の座標を求める</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong>(<em>float</em>)--1本目の直線の傾き</p></li>
<li><p><strong>b</strong>(<em>float</em>)--1本目の直線の切片</p></li>
<li><p><strong>c</strong>(<em>float</em>)--2本目の直線の傾き</p></li>
<li><p><strong>d</strong>(<em>float</em>)--2本目の直線の切片</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>float</strong>-- 交点のx座標</p></li>
<li><p><strong>float</strong>-- 交点のy座標</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://mathwords.net/nityokusenkoten">https://mathwords.net/nityokusenkoten</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_cross_point_from_point">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_cross_point_from_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p4_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p4_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_cross_point_from_point" title="Link to this definition"></a></dt>
<dd><p>4点(p1,p2,p3,p4)の交点の座標を求める</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1_x</strong>(<em>float</em>)--p1のx座標</p></li>
<li><p><strong>p1_y</strong>(<em>float</em>)--p1のy座標</p></li>
<li><p><strong>p2_x</strong>(<em>float</em>)--p2のx座標</p></li>
<li><p><strong>p2_y</strong>(<em>float</em>)--p2のy座標</p></li>
<li><p><strong>p3_x</strong>(<em>float</em>)--p3のx座標</p></li>
<li><p><strong>p3_y</strong>(<em>float</em>)--p3のy座標</p></li>
<li><p><strong>p4_x</strong>(<em>float</em>)--p4のx座標</p></li>
<li><p><strong>p4_y</strong>(<em>float</em>)--p4のy座標</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>float</strong>-- 交点のx座標</p></li>
<li><p><strong>float</strong>-- 交点のy座標</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://imagingsolution.blog.fc2.com/blog-entry-137.html">https://imagingsolution.blog.fc2.com/blog-entry-137.html</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_curdir">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_curdir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_curdir" title="Link to this definition"></a></dt>
<dd><p>スクリプトが実行されている絶対パスを取得する</p>
<p>PyInstallerでExe化した場合、実行パスがExeの保存場所でない場所を示してしまう。</p>
<p>この対策として、PyInstallerから実行されているかを判定し、スクリプトまたはExeの実行パス出力する。</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str</strong>-- 実行ファイルのカレントディレクトリ</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://qiita.com/Authns/items/f3cf6e9f27fc0b5632b3">https://qiita.com/Authns/items/f3cf6e9f27fc0b5632b3</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_filet_sita">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_filet_sita</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sita_st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sita_ed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_filet_sita" title="Link to this definition"></a></dt>
<dd><p>フィレットの開始角・終了角のなす角がpi未満となるようにラッピングする</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sita_st</strong>(<em>float</em>)--開始角</p></li>
<li><p><strong>sita_ed</strong>(<em>float</em>)--終了角</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>float</strong>-- ラッピング後の開始角</p></li>
<li><p><strong>float</strong>-- ラッピング後の終了角</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>フィレットの開始角と終了角のなす角は、必ずpi未満となる</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_flatten">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_flatten" title="Link to this definition"></a></dt>
<dd><p>1*1のサイズの配列が含まれる長さNの配列を、1*Nの配列に整形する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong>(<em>numpy.array</em>)--元の配列（内包されるデータはfloat型）</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.array</strong>-- 整形後の配列</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_spline_length">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_spline_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_spline_length" title="Link to this definition"></a></dt>
<dd><p>始点から終点までの線長を計算する</p>
<p>get_spline_length_arrayにより始点からi番目の座標点までの線長を計算した配列を計算し、配列の最後の値を出力する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--y座標点列</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong>-- 始点から終点までの線長</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.get_spline_length_array">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">get_spline_length_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.get_spline_length_array" title="Link to this definition"></a></dt>
<dd><p>与えられた座標点列に対して、始点からi番目の座標点までの線長を計算した配列を出力する</p>
<p>線長は、以下で計算する。x,yの微分は、x,y座標配列を媒介変数形式の3次スプラインで補完した後、媒介変数で微分する</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L_k = \int_{0}^{t_k}\Delta l(t) dt\\\Delta l=\sqrt{(\frac{\text{d}x}{\text{d}t})^2 + (\frac{\text{d}y}{\text{d}t})^2 }\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--y座標点列</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>np.array</strong>-- 始点からi番目の座標点までの線長を計算した配列</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.norm">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.norm" title="Link to this definition"></a></dt>
<dd><p>2次元座標における、2点(x0, y0)と(x, y)の距離dを計算する</p>
<div class="math notranslate nohighlight">
\[d = \sqrt{(x-x_0)^2 + (y-y_0)^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong>(<em>float</em>)--1つめの座標点のx座標</p></li>
<li><p><strong>y0</strong>(<em>float</em>)--1つめの座標点のy座標</p></li>
<li><p><strong>x</strong>(<em>float</em>)--2つめの座標点のx座標</p></li>
<li><p><strong>y</strong>(<em>float</em>)--2つめの座標点のy座標</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong>-- 2点(x0, y0)と(x, y)の間の距離</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.norm_3d">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">norm_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.norm_3d" title="Link to this definition"></a></dt>
<dd><p>3次元座標における、2点(x0, y0, z0)と(x, y, z)の距離dを計算する</p>
<div class="math notranslate nohighlight">
\[d = \sqrt{(x-x_0)^2 + (y-y_0)^2 +(z-z_0)^2 }\]</div>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong>(<em>float</em>)--1つめの座標点のx座標</p></li>
<li><p><strong>y0</strong>(<em>float</em>)--1つめの座標点のy座標</p></li>
<li><p><strong>z0</strong>(<em>float</em>)--1つめの座標点のz座標</p></li>
<li><p><strong>x</strong>(<em>float</em>)--2つめの座標点のx座標</p></li>
<li><p><strong>y</strong>(<em>float</em>)--2つめの座標点のy座標</p></li>
<li><p><strong>z</strong>(<em>float</em>)--2つめの座標点のz座標</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong>-- 2点(x0, y0, z0)と(x, y, z)の間の距離</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.offset_line">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">offset_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.offset_line" title="Link to this definition"></a></dt>
<dd><p>オフセットした座標点列を計算する</p>
<p>x,y の座標点列をdだけオフセットした点列を作成する。</p>
<p>オフセットした座標は、座標点における接線の傾きkを計算し、以下から計算する</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{new} = x-d\cdot\sin(k)\\y_{new} = x+d\cdot\cos(k)\end{aligned}\end{align} \]</div>
<p>接線の傾きkは、x座標の増減の向きを反映させるため、およびy軸と並行な座標点列に対応するため、arctan2を用いて計算する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--元のx座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--元のy座標点列</p></li>
<li><p><strong>d</strong>(<em>float</em>)--オフセット距離</p></li>
<li><p><strong>interp_mode</strong>(<em>str</em>)--スプラインの場合、ポリラインとしてオフセットするかどうか(linear:ポリラインとしてオフセット)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>np.array</strong>-- オフセット後のx座標点列</p></li>
<li><p><strong>np.array</strong>-- オフセット後のy座標点列</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムの参考</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/32772638/python-how-to-get-the-x-y-coordinates-of-a-offset-spline-from-a-x-y-list-of-poi">https://stackoverflow.com/questions/32772638/python-how-to-get-the-x-y-coordinates-of-a-offset-spline-from-a-x-y-list-of-poi</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.plot_3d_cut_path">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">plot_3d_cut_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">um</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_per_plot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.plot_3d_cut_path" title="Link to this definition"></a></dt>
<dd><p>3Dカットパスのうち、frameで指定された線を描画する</p>
<p>axに対し、以下の3本の線を作図する。ここでi = num_per_plot*frame</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>(x[i],y[i])-&gt;(u[i],v[i])</dt><dd><p>赤線で作図。ワークを表現する</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>(xm[i],ym[i])-&gt;(x[i],y[i])</dt><dd><p>青線で作図。ワークとCNC駆動面間の空間を表現する</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>(u[i],v[i])-&gt;(um[i],vm[i])</dt><dd><p>青線で作図。ワークとCNC駆動面間の空間を表現する</p>
</dd>
</dl>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong>(<em>matplotlib.axes</em>)--線をプロットするAxesオブジェクト</p></li>
<li><p><strong>x</strong>(<em>numpy.array</em>)--xy平面におけるワーク端のx座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--xy平面におけるワーク端のy座標点列</p></li>
<li><p><strong>u</strong>(<em>numpy.array</em>)--uv平面におけるワーク端のu座標点列</p></li>
<li><p><strong>v</strong>(<em>numpy.array</em>)--uv平面におけるワーク端のv座標点列</p></li>
<li><p><strong>xm</strong>(<em>numpy.array</em>)--xy駆動面側のCNC駆動面におけるx座標点列</p></li>
<li><p><strong>ym</strong>(<em>numpy.array</em>)--xy駆動面側のCNC駆動面におけるy座標点列</p></li>
<li><p><strong>um</strong>(<em>numpy.array</em>)--uv駆動面側のCNC駆動面におけるu座標点列</p></li>
<li><p><strong>vm</strong>(<em>numpy.array</em>)--uv駆動面側のCNC駆動面におけるv座標点列</p></li>
<li><p><strong>z_xy</strong>(<em>float</em>)--xy平面とxy駆動面側のCNC駆動面間の距離</p></li>
<li><p><strong>z_uv</strong>(<em>float</em>)--uv平面とuv駆動面側のCNC駆動面間の距離</p></li>
<li><p><strong>z_m</strong>(<em>float</em>)--xy駆動面側のCNC駆動面と、uv駆動面側のCNC駆動面との距離</p></li>
<li><p><strong>num_per_plot</strong>(<em>int</em>)--x,y,u,v配列の何点に1つ線をプロットするか（すべてプロットすると重いため）</p></li>
<li><p><strong>frame</strong>(<em>int</em>)--作図する線の番号</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>描画処理中に、例外が発生した場合、標準出力へ表示した上で、output_logによりエラーファイルにも出力する</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://matplotlib.org/stable/api/axes_api.html">https://matplotlib.org/stable/api/axes_api.html</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.poly_to_spline">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">poly_to_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.poly_to_spline" title="Link to this definition"></a></dt>
<dd><p>ezdxfのPolylineオブジェクトから、座標点列を作成する</p>
<p>ポリラインは線分の集合体なので、同じ座標点列を２個ずつ作成する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>poly_obj</strong>(<em>ezdxf.entities.Polyline</em>)--ezdxfのポリラインオブジェクト</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.array</strong>-- ポリラインの座標点列</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">課題</p>
<p>同じ座標点列を２個ずつ作成する必要性は、要検討</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="https://ezdxf.readthedocs.io/en/stable/dxfentities/polyline.html">https://ezdxf.readthedocs.io/en/stable/dxfentities/polyline.html</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.refine_line">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">refine_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.refine_line" title="Link to this definition"></a></dt>
<dd><p>線分の座標点列をリファインした座標を計算する</p>
<p>線分の場合、始点、終点のx,y座標を等間隔で分割すればよい</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--y座標点列</p></li>
<li><p><strong>N</strong>(<em>int</em>)--リファイン後の座標点列の点数</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- リファイン後のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- リファイン後のy座標点列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.refine_spline_curvature">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">refine_spline_curvature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.refine_spline_curvature" title="Link to this definition"></a></dt>
<dd><p>スプラインの座標点列を、曲率に基づいてリファインした座標を計算する</p>
<p>媒介変数表示されたスプラインでは、下式により曲率cを計算できる</p>
<div class="math notranslate nohighlight">
\[c = \frac{|x'y''-y'x''|}{(x'^2+y'^2)^{\frac{3}{2}}}\]</div>
<p>曲率cの積算値を0~1の範囲で正規化したものを用いてスプライン点列を補完することで、曲率に比例して点列を増すようにする</p>
<p>スプラインの端点は、間隔が大きいと、スプラインと他の線を結合した場合に形状を維持できないので、間隔を狭める</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--y座標点列</p></li>
<li><p><strong>N</strong>(<em>int</em>)--リファイン後の座標点列の点数</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- リファイン後のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- リファイン後のy座標点列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.remove_collision">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">remove_collision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.remove_collision" title="Link to this definition"></a></dt>
<dd><p>線が次の線と交差する場合、交差を解消した座標点列を出力する</p>
<p>以下により、線同士の交差を解消する。</p>
<blockquote>
<div><p>今の線：交点から終点までを削除</p>
<p>次の線：始点から交点までを削除</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong>(<em>_type_</em>)--今の線のx座標点列</p></li>
<li><p><strong>y1</strong>(<em>_type_</em>)--今の線のy座標点列</p></li>
<li><p><strong>x2</strong>(<em>_type_</em>)--次の線のx座標点列</p></li>
<li><p><strong>y2</strong>(<em>_type_</em>)--次の線のy座標点列</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- 交差修正後の今の線のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- 交差修正後の今の線のy座標点列</p></li>
<li><p><strong>numpy.array</strong>-- 交差修正後の次の線のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- 交差修正後の次の線のy座標点列</p></li>
<li><p><strong>bool</strong>-- True:自己交差あり/ False:自己交差なし</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.remove_same_point">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">remove_same_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.remove_same_point" title="Link to this definition"></a></dt>
<dd><p>座標点列に含まれる近傍点を削除する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>np.array</em>)--元の座標点列のx座標配列</p></li>
<li><p><strong>y</strong>(<em>np.array</em>)--元の座標点列のy座標配列</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>np.array</strong>-- 近傍点を削除した座標点列のx座標配列</p></li>
<li><p><strong>np.array</strong>-- 近傍点を削除した座標点列のy座標配列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.remove_self_collision">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">remove_self_collision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.remove_self_collision" title="Link to this definition"></a></dt>
<dd><p>線が自己交差を保つ場合、自己交差を解消した座標点列を出力する</p>
<p>自己交差の開始点と終了点を検出し、その間の座標点を削除することで自己交差を解消する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--x座標点列</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- 自己交差修正後のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- 自己交差修正後のy座標点列</p></li>
<li><p><strong>bool</strong>-- True:自己交差あり/ False:自己交差なし</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cam_generic_lib.rotate">
<span class="sig-prename descclassname"><span class="pre">cam_generic_lib.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sita</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cam_generic_lib.rotate" title="Link to this definition"></a></dt>
<dd><p>座標点列をrx,ryを回転中心として、sitaだけ反時計周りに回転する</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>(<em>numpy.array</em>)--x座標点列</p></li>
<li><p><strong>y</strong>(<em>numpy.array</em>)--y座標点列</p></li>
<li><p><strong>sita</strong>(<em>float</em>)--回転角度[rad]</p></li>
<li><p><strong>rx</strong>(<em>float</em>)--回転中心x座標</p></li>
<li><p><strong>ry</strong>(<em>float</em>)--回転中心y座標</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.array</strong>-- 回転後のx座標点列</p></li>
<li><p><strong>numpy.array</strong>-- 回転後のy座標点列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="HWCAM.html" class="btn btn-neutral float-left" title="HWCAM module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cam_global.html" class="btn btn-neutral float-right" title="cam_global module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Pakfat50.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>